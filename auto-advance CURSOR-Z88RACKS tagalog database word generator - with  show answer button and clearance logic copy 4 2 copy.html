<!DOCTYPE html>
<html lang="en">
<head>
  <title>Flashcard Word Generator</title>
  <!-- Add Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
  
  <!-- Link to the new CSS file -->
  <link rel="stylesheet" href="styles.css">
  
  <style>
    .auto-advance-controls {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .speed-control {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    #advance-speed {
      width: 60px;
      padding: 5px;
      border-radius: 4px;
      border: 1px solid var(--text-color);
      background: var(--button-bg);
      color: var(--text-color);
    }
  </style>




  <script type="module">
    // Import the HfInference class
    import { HfInference } from 'https://cdn.jsdelivr.net/npm/@huggingface/inference@2.6.1/+esm';

    // Initialize the Hugging Face Inference client
    const inference = new HfInference("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");

    // Make inference available globally
    window.inference = inference;

    // Function to load the answer and explanation
    async function loadAnswer() {
      // Logic to load the answer (this is a placeholder for your actual loading logic)
      const word = "example"; // Replace with your logic to get a random word
      document.getElementById('word-container').innerText = word; // Display the word

      // Fetch explanation from Hugging Face
   
    }

   
  
  </script>
</head>
<body style="background-color: black;"> <!-- Keep the background black -->
  <div class="container">
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
      üåô <!-- Default to moon emoji for dark mode -->
    </button>
    <h1>Tagalog Word Generator</h1>
    <div class="word-answer-container" style="display: flex; flex-direction: column; align-items: center;">
      <div class="word-container" style="display: block; margin-bottom: 20px;"> <!-- Increased margin-bottom -->
        <div id="word-container"></div> <!-- Word container -->
      </div>
      <div class="answer-container" style="display: block; min-height: 50px; margin-bottom: 20px;"> <!-- Added margin-bottom -->
        <div id="answer-container"></div> <!-- Answer container -->
      </div>
    </div>
    <div class="button-container" style="margin-top: -10px;">
      <button id="generate-button">Generate Random Word</button>
      <button id="show-answer-button">Show Answer</button>
      <button id="learned-button">Mark as Learned</button>
      <!-- Add new auto-advance controls -->
      <div class="auto-advance-controls">
        <button id="auto-advance-toggle">Start Auto-Advance</button>
        <div class="speed-control">
          <label for="advance-speed">Seconds per step:</label>
          <input type="number" 
                 id="advance-speed" 
                 min="0.5" 
                 max="60" 
                 value="3" 
                 step="0.5">
        </div>
      </div>
    </div>

    <div class="side-by-side-container">
      <button id="flip-order-button">Flip Order</button>
      <button id="reset-button">Reset Progress</button>
    </div>

    <div class="progress-container">
      <div class="progress-bar"></div>
    </div>
    <div id="progress-text"></div>
    
    <div class="explanation-container" id="explanation-container" style="display: none;"></div> <!-- Explanation container -->
    <div class="info-container" style="margin-top: 5px;">
      <span id="info-button" class="info-button" style="cursor: pointer; font-size: 34px;">‚ÑπÔ∏è</span> <!-- Changed to span for simple emoji -->
    </div>
  </div>
  
  <script src="script.js" type="module"></script> <!-- Link to the new JS file -->
  
  <script>
    function toggleTheme() {
      const root = document.documentElement;
      const themeToggleButton = document.querySelector('.theme-toggle');

      // Get the current background color of the container
      const currentBackground = getComputedStyle(root).getPropertyValue('--background').trim();

      if (currentBackground === 'rgb(30, 30, 30)') { // Dark mode (1E1E1E in RGB)
        // Switch to normal mode
        root.style.setProperty('--background', '#FFFFFF'); // Light background for container
        root.style.setProperty('--text-color', '#000000'); // Dark text color
        root.style.setProperty('--button-bg', '#F0F0F0'); // Button background for normal mode
        root.style.setProperty('--button-hover-bg', '#D0D0D0'); // Button hover background
        themeToggleButton.textContent = '‚òÄÔ∏è'; // Change to sun emoji for normal mode
      } else {
        // Switch to dark mode
        root.style.setProperty('--background', 'rgb(30, 30, 30)'); // Dark background for container
        root.style.setProperty('--text-color', '#E0E0E0'); // Light text color
        root.style.setProperty('--button-bg', '#1E1E1E'); // Button background for dark mode
        root.style.setProperty('--button-hover-bg', '#333333'); // Button hover background
        themeToggleButton.textContent = 'üåô'; // Change to moon emoji for dark mode
      }
    }

    // Add auto-advance functionality
    let autoAdvanceInterval = null;
    const autoAdvanceToggle = document.getElementById('auto-advance-toggle');
    const advanceSpeed = document.getElementById('advance-speed');

    function startAutoAdvance() {
      const secondsPerStep = parseFloat(advanceSpeed.value);
      const msPerStep = secondsPerStep * 1000;
      
      // Clear any existing interval first
      if (autoAdvanceInterval) {
        clearInterval(autoAdvanceInterval);
      }
      
      // Initial word generation
      document.getElementById('generate-button').click();
      
      // First show answer after initial delay
      setTimeout(() => {
        document.getElementById('show-answer-button').click();
      }, msPerStep);
      
      // Create the interval for the cycle
      autoAdvanceInterval = setInterval(() => {
        // Generate new word
        document.getElementById('generate-button').click();
        
        // Show answer after delay
        setTimeout(() => {
          document.getElementById('show-answer-button').click();
        }, msPerStep);
      }, msPerStep * 2);
      
      autoAdvanceToggle.textContent = 'Stop Auto-Advance';
    }

    function toggleAutoAdvance() {
      if (autoAdvanceInterval) {
        clearInterval(autoAdvanceInterval);
        autoAdvanceInterval = null;
        autoAdvanceToggle.textContent = 'Start Auto-Advance';
      } else {
        startAutoAdvance();
      }
    }

    // Add event listeners
    autoAdvanceToggle.addEventListener('click', toggleAutoAdvance);
    advanceSpeed.addEventListener('change', () => {
      if (autoAdvanceInterval) {
        // Restart with new speed
        toggleAutoAdvance();
        toggleAutoAdvance();
      }
    });

    // Add event listener for the learned button
    document.getElementById('learned-button').addEventListener('click', async () => {
      // Get the current word
      const currentWord = document.getElementById('word-container').textContent;
      
      // Update learned words in localStorage
      const learnedWords = JSON.parse(localStorage.getItem('learnedWords') || '[]');
      if (!learnedWords.includes(currentWord)) {
        learnedWords.push(currentWord);
        localStorage.setItem('learnedWords', JSON.stringify(learnedWords));
        
        // Remove from runtime available words
        availableWords = availableWords.filter(wordObj => wordObj.word !== currentWord);
        
        // Update progress
        const totalWordsCount = JSON.parse(localStorage.getItem('totalWords') || '[]').length;
        const progress = (learnedWords.length / totalWordsCount) * 100;
        document.querySelector('.progress-bar').style.width = `${progress}%`;
        document.getElementById('progress-text').textContent = 
          `Progress: ${learnedWords.length}/${totalWordsCount} words learned`;
      }
      
      // Check if there are still words available
      if (availableWords.length === 0) {
        alert('Congratulations! You have learned all the words!');
        if (autoAdvanceInterval) {
          clearInterval(autoAdvanceInterval);
          autoAdvanceInterval = null;
          autoAdvanceToggle.textContent = 'Start Auto-Advance';
        }
        return;
      }
      
      // If auto-advance is running, generate next word immediately
      if (autoAdvanceInterval) {
        document.getElementById('generate-button').click();
      }
    });

    // Update the input attributes to properly handle decimal values
    const speedInput = document.getElementById('advance-speed');
    speedInput.setAttribute('min', '0.5');
    speedInput.setAttribute('max', '60');
    speedInput.setAttribute('step', '0.5');
    speedInput.setAttribute('value', '3');
    speedInput.setAttribute('type', 'number');

    // Update the speed control label
    document.querySelector('label[for="advance-speed"]').textContent = 'Seconds per step:';

    // At the start of your script, add:
    let availableWords = []; // Runtime list of available words

    // Function to initialize the available words
    async function initializeWords() {
      try {
        const response = await fetch('words.json');
        const data = await response.json();
        // Get the normalOrder array from words.json
        availableWords = data.normalOrder.slice(); // Create a copy of the array
        
        // Remove any previously learned words
        const learnedWords = JSON.parse(localStorage.getItem('learnedWords') || '[]');
        availableWords = availableWords.filter(wordObj => 
          !learnedWords.includes(wordObj.word)
        );
      } catch (error) {
        console.error('Error loading words:', error);
      }
    }

    // Make sure to call initializeWords when the page loads
    document.addEventListener('DOMContentLoaded', initializeWords);
  </script>
</body>
</html>
